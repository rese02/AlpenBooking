rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Hoteliers can write to any booking, but the server-side logic in
    // hotel-service.ts ensures they only act on bookings for their own hotel.
    // Guests can read any booking if they have the unguessable ID.
    match /bookings/{bookingId} {
      allow read;
      allow write: if request.auth != null;
    }

    // Only authenticated users (agency/hoteliers) can list all bookings.
    // This prevents a malicious user from downloading all booking data.
    match /hotels/{hotelId} {
      allow read, write: if request.auth != null;
    }
  }
}